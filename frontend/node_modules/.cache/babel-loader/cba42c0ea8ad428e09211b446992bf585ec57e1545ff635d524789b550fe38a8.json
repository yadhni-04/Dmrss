{"ast":null,"code":"var _jsxFileName = \"/Users/yadhnikharkar/Desktop/dmrs-mvp/frontend/src/pages/DownloadPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport API from '../api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function DownloadPage() {\n  _s();\n  const [recordId, setRecordId] = useState('');\n  const [symKeyHex, setSymKeyHex] = useState('');\n  const handleDownload = async e => {\n    e.preventDefault();\n    const res = await API.get(`/records/record/${recordId}`);\n    const cid = res.data.cid;\n    const response = await fetch(`http://127.0.0.1:8080/ipfs/${cid}`);\n    const blob = await response.arrayBuffer();\n    const key = new Uint8Array(Buffer.from(symKeyHex, 'hex'));\n    const iv = blob.slice(0, 12);\n    const tag = blob.slice(12, 28);\n    const ciphertext = blob.slice(28);\n    const cryptoKey = await window.crypto.subtle.importKey('raw', key, {\n      name: 'AES-GCM'\n    }, false, ['decrypt']);\n    const decrypted = await window.crypto.subtle.decrypt({\n      name: 'AES-GCM',\n      iv: new Uint8Array(iv),\n      tagLength: 128\n    }, cryptoKey, ciphertext);\n    const fileBlob = new Blob([decrypted]);\n    const url = URL.createObjectURL(fileBlob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `${recordId}.pdf`;\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Download & Decrypt Record\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleDownload,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        placeholder: \"Record ID\",\n        value: recordId,\n        onChange: e => setRecordId(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 101\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 106\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        placeholder: \"Symmetric Key (hex)\",\n        value: symKeyHex,\n        onChange: e => setSymKeyHex(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 113\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 118\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Download\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 34,\n    columnNumber: 5\n  }, this);\n}\n_s(DownloadPage, \"GU7BfxRSkYfeUEpYsraEV7aKTMQ=\");\n_c = DownloadPage;\nvar _c;\n$RefreshReg$(_c, \"DownloadPage\");","map":{"version":3,"names":["React","useState","API","jsxDEV","_jsxDEV","DownloadPage","_s","recordId","setRecordId","symKeyHex","setSymKeyHex","handleDownload","e","preventDefault","res","get","cid","data","response","fetch","blob","arrayBuffer","key","Uint8Array","Buffer","from","iv","slice","tag","ciphertext","cryptoKey","window","crypto","subtle","importKey","name","decrypted","decrypt","tagLength","fileBlob","Blob","url","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","remove","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","placeholder","value","onChange","target","type","_c","$RefreshReg$"],"sources":["/Users/yadhnikharkar/Desktop/dmrs-mvp/frontend/src/pages/DownloadPage.js"],"sourcesContent":["import React, { useState } from 'react';\nimport API from '../api';\n\nexport default function DownloadPage() {\n  const [recordId,setRecordId]=useState('');\n  const [symKeyHex,setSymKeyHex]=useState('');\n\n  const handleDownload=async(e)=>{\n    e.preventDefault();\n    const res=await API.get(`/records/record/${recordId}`);\n    const cid=res.data.cid;\n    const response=await fetch(`http://127.0.0.1:8080/ipfs/${cid}`);\n    const blob=await response.arrayBuffer();\n    const key=new Uint8Array(Buffer.from(symKeyHex,'hex'));\n\n    const iv=blob.slice(0,12);\n    const tag=blob.slice(12,28);\n    const ciphertext=blob.slice(28);\n\n    const cryptoKey=await window.crypto.subtle.importKey('raw', key, {name:'AES-GCM'}, false, ['decrypt']);\n    const decrypted=await window.crypto.subtle.decrypt({name:'AES-GCM', iv: new Uint8Array(iv), tagLength:128}, cryptoKey, ciphertext);\n\n    const fileBlob=new Blob([decrypted]);\n    const url=URL.createObjectURL(fileBlob);\n    const a=document.createElement('a');\n    a.href=url;\n    a.download=`${recordId}.pdf`;\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n  }\n\n  return (\n    <div>\n      <h2>Download & Decrypt Record</h2>\n      <form onSubmit={handleDownload}>\n        <input placeholder=\"Record ID\" value={recordId} onChange={e=>setRecordId(e.target.value)} /><br/><br/>\n        <input placeholder=\"Symmetric Key (hex)\" value={symKeyHex} onChange={e=>setSymKeyHex(e.target.value)} /><br/><br/>\n        <button type=\"submit\">Download</button>\n      </form>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}